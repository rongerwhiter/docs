# Swoole 项目起源和名字由来

!> This page is written by Rango, the founder of the Swoole open-source project, and represents his personal views.
## プロジェクトの起源

Swooleプロジェクトの最初のアイデアは、以前に行った企業ソフトウェアプロジェクトからきています。当時はおそらく2010年の末で、会社の製品には、ユーザーが任意のメールアドレスを生成し、他のユーザーがそのメールアドレスにメールを送信できるようにし、バックエンドでメールの内容をリアルタイムでデータに解析し、ユーザーにアクティブに通知するという要件がありました。当時のプロジェクトはPHPで開発されており、この要件を実現する際に課題に直面しました。PHPは他のSMTPサーバーに依存し、pop3プロトコルを使用して新しいメールを定期的に受信して処理する必要があり、これではリアルタイムではありませんでした。リアルタイムシステムを実現するには、自分で`TCPソケットサーバー`を書いて`SMTP`プロトコルでデータを受け取る必要がありました。当時、`PHP`はこの分野でほとんど存在感がなく、成熟したネットワーク通信フレームワークが存在しませんでした。要件を実現するために、私は`socket`から始まり、`TCP/IP`、IOマルチプレクシング、`libevent`、複数プロセスと学び、最終的にこのプログラムを完成させました。このプロジェクトが終わった後、このプログラムをオープンソース化し、他のPHPerがこの分野での課題を解決できるようにしたいと考えました。このようなフレームワークがあれば、PHPは単にWebサイトを作成するだけでなく、より大きな領域に拡張できるようになります。
## 性能問題

もう一つの重要な理由はPHPプログラムのパフォーマンスの問題です。私自身、最初はJavaを学んでおり、仕事をしてからPHPプログラマーに転身しました。PHPプログラムを開発する過程で、私は常に考えていたのは PHP と Java の最大の利点は何かということです。シンプルで効率的で、PHPはリクエスト完了後にすべてのリソースとメモリを解放し、メモリリークの心配は不要です。コードの品質が高かろうと低かろうと同じようにスムーズに動作します。しかし、同時にこれはPHPの致命的な欠点でもあります。リクエストの数が増え、同時に多くの並行リクエストがあると、リソースを急速に作成し、すぐに解放することで、PHPプログラムの実行効率が急激に低下します。さらに、プロジェクトの機能が複雑になり、コードが増えると、PHPにとっても災害となります。これがなぜPHPのフレームワークがPHPプログラマーに広く受け入れられていないかの理由ですが、Javaではこの問題が存在しないからです。どんなに優れたフレームワークでも、この低効率な方法によって引きずられ、システムが遅くなる可能性があります。ですので、PHPを使用してPHPアプリケーションサーバーを開発することを考えました。PHPのコードをメモリにロードした後、より長いライフサイクルを持たせ、作成されたデータベース接続やその他の大きなオブジェクトが解放されないようにします。各リクエストはごく少量のコードのみを処理する必要があり、このコードはPHPパーサーによって最初に実行されるときにのみコンパイルされ、メモリに留まります。また、以前はPHPでは実現できなかった、オブジェクトの永続化、データベースコネクションプール、キャッシュコネクションプールも実現できます。システムの実行効率が大幅に向上します。

一定の研究を経て、現在は実装を初めています。PHP自体を使用してHTTPサーバーを作成し、独立したサーバーとして実行することで、個々のプログラムページ（オブジェクトの生成、データベース接続、Smartyテンプレート操作が含まれる）の実行時間は0.0x秒から0.00x秒に短縮されました。Apache ABを使用して100の同時接続テストを実行しました。従来のLAMP方法よりも少なくとも10倍のRequest per Secondを達成しました。私のテスト環境では（Ubuntu 10.04 Inter Core E5300 + 2Gメモリ）、Apacheは83RPSまでしか実行されませんでした。Swoole Serverでは1150以上のRPSが実行できます。

このプロジェクトはSwooleの原型です。このバージョンは2年以上も継続してメンテナンスされており、その過程でいくつかの経験が蓄積され、この技術ソリューションに対する問題点（パフォーマンスの低さ、多くの制限により直接的なOSインターフェースを呼び出すことができないこと、メモリ管理の効率の低さなど）について、より深い理解を得ました。
## テンセント入社

2011年末、私はテンセントに入社し、QQのPHPプラットフォーム開発を担当しました。驚いたことに、QQのチームメイトはただそれを考えるだけでなく、すでに実現していたのです。QQチームはすでにこのシステムを本番環境で使用していました。QQには3つの主要なコンポーネントがあります。1つ目はPWSで、これは純粋なPHPで書かれたWebサーバーで、600台以上のサーバーがPWS上で稼働しており、ApacheやPHP-FPMなどのプログラムを一切使用していません。2つ目はSAPSで、これは純粋なPHPで開発された分散キューで、当時約150台のサーバーがクラスターとして稼働しており、画像の切り抜き、アバター処理、同時メッセージ、データ同期などの多くのロジックがSAPSを使って非同期で実行されていました。そして3つ目はPSFで、これはPHPで実装されたサーバーフレームワークで、QQの多くのロジックサーバーはPSFをベースに実装されています。PSFサーバープログラムはおおよそ300台ほどのクラスターで稼働しています。QQでのこの期間に、私は多くのLinuxの低レイヤーやネットワーク通信に関する知識を学び、大規模なクラスターや高並行環境でのネットワーク通信のトレーシングやデバッグの経験を積みました。これはSwooleの開発にとって非常に良い基盤を築くことができました。
## Swooleの開発

この期間中、Node.jsやGolangなどの優れた技術ソリューションも学習し、さらなるインスピレーションを得ました。2012年には新しいアイデアが出て、より高性能で機能が強力なバージョンをC言語で再実装することを決定しました。これが現在のSwoole拡張機能です。

現在、Swooleは多くのPHP技術チームによって実際のプロジェクト開発で使用されており、国内外で使用されています。国内では、有名な企業には百度のオーダーセンター、百度マップ、テンセントのQQ公众号および企業QQ、戦旗ライブ、360、当当ネット、穷游などがあります。また、多くのIoT、ハードウェア、ゲームプロジェクトでもSwooleが使用されています。さらに、TSF、Blink、swPromiseなどのSwooleベースのオープンソースフレームワークも増えており、GitHubでも多くのSwoole関連のプロジェクトやコードが見つかります。
## 名前の由来

Swooleという名前は英単語ではなく、私が作り出した近い音の言葉です。最初に思いついた名前は`sword-server`というもので、これは多くのPHPerたちに鋭い剣を提供するという意味合いを持っています。後に、Googleも空想から生まれたものだと考えたので、私はそれに`swoole`という名前を付けました。
