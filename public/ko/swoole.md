# Swoole Project History and Name Origin

!> This page was written by Rango, the founder of the Swoole open source project, and represents his personal views.
## 프로젝트 기원

Swoole 프로젝트의 아이디어는 이전에 진행한 기업 소프트웨어 프로젝트에서 비롯되었습니다. 대략 2010년 말쯤, 회사 제품 중 하나는 사용자가 임의의 이메일 주소를 생성하고 다른 사용자가 해당 이메일로 이메일을 보낼 수 있고, 백그라운드에서는 이메일 내용을 실시간으로 데이터로 파싱하고 사용자에게 알림하는 요구사항이 있었습니다. 당시 이 프로젝트는 PHP로 개발되었는데, 이 요구사항을 구현하는 중에 어려움을 겪었습니다. PHP는 다른 SMTP 서버에 의존해야 하며, pop3 프로토콜을 사용하여 주기적으로 새 이메일을 확인해야 했기 때문에 실시간이 아니었습니다. 실시간 시스템을 구현하려면 `TCP 소켓 서버`를 작성하여 `SMTP` 프로토콜을 통해 데이터를 받아야 했습니다. 그 당시에는 `PHP`가 이 분야에서 거의 공백이었고, 완성된 네트워크 통신 프레임워크가 없었습니다. 이 요구사항을 충족시키기 위해, 나는 `socket`부터 시작해서 `TCP/IP`, IO 다중화, `libevent`, 다중 프로세스까지 공부하여 마침내 이 프로그램을 완성하게 되었습니다. 이 프로젝트를 끝낸 후, 나는 이 프로그램을 오픈 소스로 공개하고, 다른 PHPer이 이 분야에서의 어려움을 해결하는 데 도움을 줄 수 있기를 희망했습니다. 이러한 프레임워크가 있다면 PHP는 단순한 웹 사이트를 구축하는 데서 더 큰 영역으로 확장될 수 있다고 생각했습니다.
## 성능 문제

또 다른 중요한 이유는 PHP 프로그램의 성능 문제입니다. 저는 처음에는 Java를 배웠고, 일을 시작한 후 PHP 프로그래머로 전향했습니다. PHP 프로그램을 개발하는 과정에서, PHP와 Java를 비교했을 때 PHP의 가장 큰 장점은 무엇인가요? 간단하고 효율적이며, PHP는 요청을 완료한 후 모든 리소스와 메모리를 해제하기 때문에 메모리 누수를 걱정할 필요가 없습니다. 코드의 품질이 좋든 나쁘든 같은 방식으로 매끄럽게 실행됩니다. 그러나 동시에 이것은 PHP의 치명적인 결점이기도 합니다. 한번에 많은 요청이 들어오고 동시에 많은 요청이 발생할 때, 리소스를 빠르게 생성한 다음 즉시 해제하면 PHP 프로그램의 실행 효율이 급격히 떨어집니다. 또한 프로젝트의 기능이 점점 복잡해지고 코드가 많아지면 PHP에게도 재앙이 될 것입니다. 이것이 PHP의 프레임워크가 PHP 프로그래머에게 널리 받아 들여지지 않는 이유이며, Java에서는 이러한 문제가 없는 이유입니다. 얼마나 좋은 프레임워크도 이러한 비효율적인 방식으로 뒤엎을 것이고, 시스템이 느려지게 될 것입니다. 그래서 PHP로 PHP 애플리케이션 서버를 개발하기로 결심했고, PHP 코드를 메모리에 로드한 후 더 긴 수명을 갖도록 하였습니다. 이렇게 구축된 데이터베이스 연결 및 기타 큰 객체는 해제되지 않습니다. 각 요청은 매우 적은 코드만 처리해야 하며, 이 코드들은 PHP 파서에 의해 컴파일된 후 처음 실행될 때 메모리에 상주합니다. 게다가, 이전에 PHP로 구현할 수 없었던 객체 지속성, 데이터베이스 연결 풀, 캐시 연결 풀 모두 구현할 수 있습니다. 시스템의 실행 효율이 크게 향상될 것입니다.

조사를 통해 일정 시간 후 현재까지 구현의 초안을 얻었습니다. PHP로 HTTP 서버를 작성하여 독립 서버로 실행하고, 개별 프로그램 페이지(객체 생성, 데이터베이스 연결, smarty 템플릿 조작)의 실행 시간을 원래의 0.0x초에서 0.00x초로 낮추었습니다. Apache AB를 사용하여 100의 동시성 테스트를 수행했을 때, 기존 LAMP 방식보다 요청 당 초당 최소 10배 이상 높은 쿼리를 처리할 수 있습니다. 제 시험 환경에서(Ubuntu10.04 Intel Core E5300 + 2G 메모리), Apache는 83RPS까지만 처리할 수 있습니다. 그에 비해 Swoole Server는 1150 이상의 RPS를 처리할 수 있습니다.

이 프로젝트는 Swoole의 초안입니다. 이 버전은 2년 이상 계속 유지되었고, 이 과정에서 경험을 쌓아가며 해당 기술 솔루션의 문제점을 보다 깊이 이해하게 되었습니다. 성능이 좋지 않고, 제한이 많아서 직접적으로 운영 체제 인터페이스를 호출할 수 없으며, 메모리 관리 효율이 낮다는 것 같은 문제점이 있습니다.
2011 년 말에 나는 텐센트에 입사하여 친구네트워크의 PHP 플랫폼 개발을 담당했습니다. 놀라운 일이었다. 친구네트워크 팀원들은 그냥 생각만 하는 것이 아니라 실제로 실행했다. 친구네트워크 팀은 이미 이 솔루션을 운영환경에 도입했습니다. 친구네트워크에는 세 대의 마차가 있습니다. 첫 번째는 PWS인데, 이는 PHP로 작성된 웹 서버입니다. 친구네트워크에는 PWS를 기반으로 운영 중인 서버가 600 대 이상이며 Apache, PHP-FPM 등의 프로그램을 전혀 사용하지 않았습니다. 두 번째는 SAPS인데, 이는 순수 PHP로 개발된 분산 큐 시스템입니다. 그 당시에는 약 150 대의 서버 클러스터에서 작동하고 있었으며, 이미지 크롭, 아바타 처리, 메시지 동시성, 데이터 동기화 등의 로직은 모두 SAPS를 사용하여 비동기적으로 처리했습니다. 세 번째는 PSF인데, 이는 PHP로 구현된 서버 프레임워크입니다. 친구네트워크의 많은 로직 레이어 서버는 PSF를 기반으로 구현되었습니다. 대략 300 대가 PSF 서버 프로그램을 실행 중입니다. 친구네트워크에서 보낸 이 기간 동안 Linux 하위 시스템 및 네트워크 통신에 대한 지식을 많이 배우고 대형 클러스터 및 고도로 동시성 환경에서의 네트워크 통신 추적 및 디버깅 경험을 쌓아 Swoole 개발을 위한 훌륭한 기초를 마련했습니다.
## Swoole 개발

이 과정에서 Node.js, Golang과 같은 우수한 기술 솔루션도 학습하여 더 많은 영감을 얻었습니다. 2012년에 새로운 아이디어를 가지고 C 언어를 사용하여 성능이 뛰어나고 더 강력한 기능을 갖춘 새로운 버전을 구현하기로 결정했습니다. 그 결과, 현재의 Swoole 확장이 탄생했습니다.

현재 Swoole는 많은 PHP 기술 팀에서 실제 프로젝트 개발에 사용되고 있으며 국내외에서도 사용되고 있습니다. 국내에서는 유명한 기업으로는 바이두 주문 센터, 바이두 맵, 텐센트 QQ 공식 계정 및 기업 QQ, 전퀴 방송, 360, 당당넷, 궁유 등이 있습니다. 또한 많은 사물 인터넷, 하드웨어, 게임 프로젝트들도 Swoole을 사용하고 있습니다. 또한 Swoole을 기반으로 한 오픈 소스 프레임워크도 점점 더 많아지고 있습니다. TSF, Blink, swPromise 등이 있으며 GitHub에서도 많은 Swoole 관련 프로젝트와 코드를 찾을 수 있습니다.
## 이름의 유래

Swoole이라는 이름은 영어 단어가 아니며, 저가 만들어낸 유사 음으로 이루어져 있습니다. 처음에 떠오른 이름은 'sword-server'로, 이는 많은 PHP 개발자들에게 날카로운 칼을 제공하고자 하는 의미를 내포하고 있습니다. 그러나 후에 Google도 공중에서 창조되었다는 사실을 떠올려 'swoole'이라는 이름을 지어주었습니다.
